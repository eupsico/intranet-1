<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Painel de Recursos Humanos - EuPsico</title>

  <link rel="stylesheet" href="../../../assets/css/design-system.css" />
  <link rel="stylesheet" href="../css/rh.css" />

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.1/jspdf.plugin.autotable.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body>
  <div id="app">
    <div id="login-view"></div>

    <div id="dashboard-view">
      <div class="layout-container">

        <nav class="sidebar">
          <div class="sidebar-content-wrapper">
            <ul id="sidebar-menu" class="sidebar-menu"></ul>
          </div>
        </nav>

        <div id="menu-overlay" class="menu-overlay"></div>

        <header class="header">
          <div class="header-start">
            <button id="sidebar-toggle" type="button" title="Alternar menu" aria-label="Alternar menu lateral">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="3" y1="12" x2="21" y2="12"></line>
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="3" y1="18" x2="21" y2="18"></line>
              </svg>
            </button>
            <div id="page-title-container"></div>
          </div>

          <div class="user-profile-header">
            <img id="user-photo-header" src="" alt="Foto do usu√°rio" />
            <span id="user-greeting"></span>
            <a href="#" id="logout-button-dashboard" class="logout-button-dashboard">Sair</a>
          </div>
        </header>

        <main class="main-content">
          <div id="content-area" class="tab-content-area">
            <div class="loading-spinner"></div>
          </div>
        </main>

      </div>
    </div>
  </div>

  <div id="rh-views" style="display: none">
    <div data-view-id="gestao_profissionais"></div>
    <div data-view-id="gestao_vagas"></div>
    <div data-view-id="gestao_documentos"></div>
    <div data-view-id="admissao"></div>
    <div data-view-id="onboarding_colaboradores"></div>
    <div data-view-id="desligamento"></div>
    <!-- ... outras views ... -->
    <div data-view-id="comunicados"></div>
  </div>

  <!-- ‚úÖ SCRIPT DE INICIALIZA√á√ÉO DO FIREBASE (NOVO - CR√çTICO) -->
  <script>
    /**
     * Inicializa√ß√£o S√çNCRONA do Firebase SDK com suporte modular
     * Exp√µe globalmente em window.firebaseServices
     * DEVE executar ANTES de admissao.js e app.js
     */
    (async function initFirebaseSDK() {
      try {
        // Importa m√≥dulos Firebase do CDN
        const { initializeApp } = await import('https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js');
        const { getFirestore } = await import('https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js');
        const { getFunctions, httpsCallable } = await import('https://www.gstatic.com/firebasejs/10.13.1/firebase-functions.js');
        const { getAuth } = await import('https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js');
        const firebaseFirestore = await import('https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js');

        // ‚úÖ Configura√ß√£o Firebase (SUBSTITUA pelos valores reais do seu projeto)
        const firebaseConfig = {
          apiKey: "AIzaSyB...", // Cole sua apiKey aqui
          authDomain: "eupsico-agendamentos-d2048.firebaseapp.com",
          projectId: "eupsico-agendamentos-d2048",
          storageBucket: "eupsico-agendamentos-d2048.appspot.com",
          messagingSenderId: "123456789", // Seu sender ID
          appId: "1:123456789:web:abcdef123456" // Seu app ID
        };

        // Inicializa Firebase App
        const app = initializeApp(firebaseConfig);

        // ‚úÖ CR√çTICO: Inicializa Functions com a regi√£o southamerica-east1
        const functions = getFunctions(app, 'southamerica-east1');

        // Inicializa outros servi√ßos
        const db = getFirestore(app);
        const auth = getAuth(app);

        // ‚úÖ EXP√ïE GLOBALMENTE - Isso torna os servi√ßos acess√≠veis para seus m√≥dulos
        window.firebaseServices = {
          app,
          db,
          functions,
          auth,
          httpsCallable,
          // Firestore Functions
          serverTimestamp: firebaseFirestore.serverTimestamp,
          getDoc: firebaseFirestore.getDoc,
          setDoc: firebaseFirestore.setDoc,
          addDoc: firebaseFirestore.addDoc,
          updateDoc: firebaseFirestore.updateDoc,
          deleteDoc: firebaseFirestore.deleteDoc,
          collection: firebaseFirestore.collection,
          doc: firebaseFirestore.doc,
          arrayUnion: firebaseFirestore.arrayUnion,
          arrayRemove: firebaseFirestore.arrayRemove,
          query: firebaseFirestore.query,
          where: firebaseFirestore.where,
          getDocs: firebaseFirestore.getDocs,
          onSnapshot: firebaseFirestore.onSnapshot,
          FieldValue: firebaseFirestore.FieldValue,
        };

        console.log("‚úÖ Firebase SDK inicializado com sucesso!");
        console.log("üìç Regi√£o Functions: southamerica-east1");
        console.log("üîó Servi√ßos dispon√≠veis em window.firebaseServices");

      } catch (error) {
        console.error("‚ùå ERRO ao inicializar Firebase SDK:", error);
        console.error("Verifique:");
        console.error("  1. Sua conex√£o com a internet");
        console.error("  2. Sua configura√ß√£o Firebase (apiKey, projectId, etc)");
        console.error("  3. Se est√° usando a vers√£o 10.13.1 do Firebase SDK");
        throw error;
      }
    })();
  </script>

  <!-- ‚úÖ Script inline para toggle (mantido como estava) -->
  <script>
    /**
     * Controla a visibilidade dos campos de Aprova√ß√£o/Reprova√ß√£o na Triagem.
     * Esta fun√ß√£o √© chamada quando o usu√°rio seleciona Sim/N√£o no radio button.
     */
    window.toggleMotivoAprovacaoRejeicao = function () {
      const radioSim = document.getElementById("modal-apto-sim");
      const radioNao = document.getElementById("modal-apto-nao");

      const reprovacaoContainer = document.getElementById("modal-motivo-rejeicao-container");
      const reprovacaoTextarea = document.getElementById("modal-motivo-rejeicao");

      const aprovacaoContainer = document.getElementById("modal-info-aprovacao-container");
      const aprovacaoTextarea = document.getElementById("modal-info-aprovacao");

      // Verifica√ß√£o de seguran√ßa
      if (!reprovacaoContainer || !aprovacaoContainer || !radioSim || !radioNao) {
        console.warn("toggleMotivoAprovacaoRejeicao: Elementos n√£o encontrados.");
        return;
      }

      // Remove obrigatoriedade por padr√£o
      if (reprovacaoTextarea) reprovacaoTextarea.required = false;
      if (aprovacaoTextarea) aprovacaoTextarea.required = false;

      if (radioNao.checked) {
        // Reprova√ß√£o: Mostra motivo detalhado (OBRIGAT√ìRIO)
        reprovacaoContainer.style.display = "block";
        if (reprovacaoTextarea) reprovacaoTextarea.required = true;
        aprovacaoContainer.style.display = "none";

      } else if (radioSim.checked) {
        // Aprova√ß√£o: Mostra pr√≥ximos passos (OPCIONAL)
        aprovacaoContainer.style.display = "block";
        reprovacaoContainer.style.display = "none";

      } else {
        // Nenhum selecionado: Oculta ambos
        reprovacaoContainer.style.display = "none";
        aprovacaoContainer.style.display = "none";
      }
    };
  </script>

  <!-- ‚úÖ Seus scripts modulares (AP√ìS a inicializa√ß√£o do Firebase) -->
  <script type="module" src="../../../assets/js/firebase-init.js"></script>
  <script type="module" src="../../../assets/js/app.js"></script>
  <!-- ‚úÖ Se usar admissao.js diretamente, adicione aqui (opcional se j√° est√° em app.js) -->
  <!-- <script type="module" src="modulos/rh/js/admissao.js"></script> -->
</body>

</html>
