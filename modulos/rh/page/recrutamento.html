<div class="painel-recrutamento">
<h2 class="painel-titulo">Recrutamento e Seleção</h2>

<div class="description-box">
 <p>
 Este painel gerencia o processo seletivo para vagas em divulgação, desde o
 estabelecimento de cronogramas, triagem de candidatos, até a entrevista
 final e contratação.
 </p>
</div>

<div class="acoes-header">
 <div class="form-group" style="margin-bottom: 0">
 <label for="filtro-vaga" style="font-weight: 600"
  >Filtrar por Vaga:</label
 >
 <select id="filtro-vaga" class="select-filtro">
  <option value="">Selecione uma Vaga...</option>
 </select>
 </div>
</div>

<div class="tabs-container status-tabs" id="status-candidatura-tabs">
 <button class="tab-link active" data-status="cronograma">
 1. Cronograma e Orçamento
 </button>
 <button class="tab-link" data-status="triagem">
 2. Triagem de Currículo (0)
 </button>
 <button class="tab-link" data-status="entrevistas">
 3. Entrevistas e Avaliações (0)
 </button>
 <button class="tab-link" data-status="gestor">
 4. Entrevista com Gestor (0)
 </button>
 <button class="tab-link" data-status="finalizados">
 5. Finalizados (0)
 </button>

 <button
 class="tab-link btn-secondary"
 data-status="gestao-conteudo"
 id="btn-gestao-conteudo"
 style="margin-left: auto"
 >
 <i class="fas fa-tools"></i> Gerenciar Estudos/Testes
 </button>
</div>

<div id="conteudo-recrutamento" class="tabela-dados">
 <p id="mensagem-inicial">
 Selecione uma vaga no filtro acima para iniciar a visualização do processo
 seletivo.
 </p>
</div>

<div id="modal-candidato" class="modal-overlay">
 <div class="modal-content" style="max-width: 800px">
 <form id="form-candidatura">
  <div class="modal-header">
  <h3 id="candidato-nome-titulo">Detalhes da Candidatura</h3>
  <button type="button" class="close-modal-btn fechar-modal-candidato">
   &times;
  </button>
  </div>

  <div class="modal-body" id="candidato-modal-body"></div>

  <div class="modal-footer" id="candidato-modal-footer">
  <button
   type="button"
   class="btn btn-secondary fechar-modal-candidato"
  >
   Fechar
  </button>
  </div>
 </form>
 </div>
</div>
</div>

<div id="modal-edicao-cronograma" class="modal-overlay">
 <div class="modal-content">
  <div class="modal-header">
   <h3 class="modal-title-text">Ajustar Cronograma e Orçamento</h3>
   <button type="button" class="close-modal-btn" data-modal-id="modal-edicao-cronograma">&times;</button>
  </div>
  <form id="form-edicao-cronograma">
   <div class="modal-body">
    
    <div class="modal-section">
      <h4>Datas Previstas</h4>
      <div class="details-grid cols-2">
        <div class="form-group">
          <label for="modal-data-inicio-recrutamento" class="form-label">Início do Recrutamento</label>
          <input type="date" class="form-control" id="modal-data-inicio-recrutamento" required />
        </div>
        <div class="form-group">
          <label for="modal-data-fechamento-recrutamento" class="form-label">Encerramento do Recrutamento</label>
          <input type="date" class="form-control" id="modal-data-fechamento-recrutamento" required />
        </div>
        <div class="form-group">
          <label for="modal-data-contratacao-prevista" class="form-label">Contratação</label>
          <input type="date" class="form-control" id="modal-data-contratacao-prevista" required />
        </div>
      </div>
    </div>

    <div class="modal-section">
      <h4>Recursos e Orçamento</h4>
      <div class="details-grid cols-2">
        <div class="form-group">
          <label for="modal-orcamento-previsto" class="form-label">Orçamento Previsto (R$)</label>
          <input type="number" step="0.01" class="form-control" id="modal-orcamento-previsto" placeholder="Ex: 500.00" required />
        </div>
        <div class="form-group">
          <label for="modal-fonte-orcamento" class="form-label">Fonte do Orçamento</label>
          <input type="text" class="form-control" id="modal-fonte-orcamento" placeholder="Ex: Área de Marketing/Verba de RH" />
        </div>
      </div>
    </div>

    <div class="modal-section">
      <div class="form-group full-width">
        <label for="modal-detalhes-cronograma" class="form-label">Observações e Detalhes</label>
        <textarea class="form-control" id="modal-detalhes-cronograma" rows="3" placeholder="Detalhes importantes sobre a urgência ou complexidade do recrutamento."></textarea>
      </div>
    </div>

   </div>
   <div class="modal-footer">
    <button type="button" class="action-button secondary" data-modal-id="modal-edicao-cronograma">
     Cancelar
    </button>
    <button type="submit" id="btn-salvar-modal-cronograma" class="action-button">
     <i class="fas fa-save me-2"></i> Salvar Ajustes
    </button>
   </div>
  </form>
 </div>
</div>
<div id="modal-avaliacao-triagem" class="modal-overlay">
<div class="modal-content" style="max-width: 900px">
 <div class="modal-header">
 <h3 id="avaliacao-modal-title">Avaliação de Triagem - [Nome Candidato]</h3>
 <button type="button" class="close-modal-btn" data-modal-id="modal-avaliacao-triagem">&times;</button>
 </div>
 <div class="modal-body">
 <div class="row">
    <div class="col-lg-6">
  <div class="card card-shadow mb-4">
   <div class="card-header bg-card-header-eu">
   <h2 class="mb4- text-white">
    Ficha de Candidatura - 
    <span id="candidato-modal-nome">Candidato(a)</span>
   </h2>
   </div>
   <div class="card-body">
   <p class="card-text">
    <strong>Email:</strong> <span id="modal-dado-email">...</span>
   </p>
   <p class="card-text">
    <strong>Telefone (WhatsApp):</strong>
    <span id="modal-dado-telefone">...</span>
   </p>
   <p class="card-text">
    <strong>Cidade/Estado:</strong>
    <span id="modal-dado-cidade-estado">...</span>
   </p>
   <p class="card-text">
    <strong>Como conheceu a EuPsico:</strong>
    <span id="modal-dado-como-conheceu">...</span>
   </p>

   <hr />
   <h6>Resumo da Experiência Profissional:</h6>
   <p id="modal-dado-resumo-experiencia" class="text-muted ">...</p>

   <h6>Habilidades/Competências:</h6>
   <p id="modal-dado-habilidades" class="text-muted ">...</p>

   <hr />
   </div>
  </div>
  </div>
  
    <div class="col-lg-6">
  <div class="card card-shadow">
   <div class="card-header bg-info-subtle">
   <h5 class="mb-0">Avaliação de Triagem (RH)</h5>
   </div>
   <div class="card-body">
   <form id="form-avaliacao-triagem-modal">
    <input type="hidden" id="candidatura-id-modal" value="">
    
    <fieldset class="mb-4">
     <legend>Checklist Rápido</legend>
     <div id="checklist-triagem-container">
           </div>
    </fieldset>

        <div class="mb-3 form-group">
    <label for="prerequisitos-atendidos" class="form-label"
     >Quais Pré-requisitos Técnicos o(a) Candidato(a) Atende?</label
    >
    <textarea
     class="form-control"
     id="modal-prerequisitos-atendidos"
     rows="3" 
     required
    ></textarea>
    </div>
 
        <div class="mb-3 form-group">
    <label class="form-label d-block"
     >Apto(a) para a Entrevista?</label
    >
    <div class="form-check form-check-inline">
     <input
     class="form-check-input"
     type="radio"
     name="modal-apto-entrevista"
     id="modal-apto-sim"
     value="Sim"
     required
     />
     <label class="form-check-label" for="modal-apto-sim"
     >Sim (Aprovar)</label
     >
    </div>
    <div class="form-check form-check-inline">
     <input
     class="form-check-input"
     type="radio"
     name="modal-apto-entrevista"
     id="modal-apto-nao"
     value="Não"
     />
     <label class="form-check-label" for="modal-apto-nao"
     >Não (Reprovar)</label
     >
    </div>
    </div>
 
        <div
    class="mb-3 form-group"
    id="modal-info-aprovacao-container"
    style="display: none"
    >
    <label for="modal-info-aprovacao" class="form-label"
     >Próximos Passos ou Informações de Aprovação</label
    >
    <textarea
     class="form-control"
     id="modal-info-aprovacao"
     rows="3"
     placeholder="Ex: Agendar entrevista RH para próxima semana, foco em habilidades X e Y."
    ></textarea>
    </div>
 
        <div
    class="mb-3 form-group"
    id="modal-motivo-rejeicao-container"
    style="display: none"
    >
    <label for="modal-motivo-rejeicao" class="form-label"
     >Motivo Detalhado da Reprovação</label
    >
    <textarea
     class="form-control"
     id="modal-motivo-rejeicao"
     rows="3"
     placeholder="Descreva o motivo da reprovação (Ex: Falha em pré-requisito técnico, salário incompatível, etc.)."
    ></textarea>
    </div>

        <div class="mb-3 form-group">
    <label for="comentarios-gerais" class="form-label"
     >Comentários Gerais da Triagem</label
    >
    <textarea
     class="form-control"
     id="modal-comentarios-gerais"
     rows="3"
    ></textarea>
    </div>
   </form>
   </div>
  </div>
  </div>
 </div>
 </div>
 
 <div class="modal-footer">
    <button 
      type="button" 
      class="action-button info me-auto" 
      id="btn-ver-curriculo-triagem" 
      disabled>
  <i class="fas fa-file-pdf me-2"></i> Ver Currículo
 </button>
     <button type="button" class="action-button secondary" data-modal-id="modal-avaliacao-triagem">
  <i class="fas fa-times me-2"></i> Fechar
 </button>
 <button type="submit" id="btn-finalizar-triagem-modal" class="action-button success">
  <i class="fas fa-check-circle me-2"></i> Registrar Decisão e Salvar
 </button>
 </div>

</div>
</div>

<script>
<script>
    // Esta função controla a visibilidade dos campos de texto (Aprovação/Reprovação).
    window.toggleMotivoAprovacaoRejeicao = () => {
        const radioSim = document.getElementById("modal-apto-sim");
        const radioNao = document.getElementById("modal-apto-nao");
        
        // Novos campos a serem controlados
        const comentariosGeraisContainer = document.getElementById("modal-comentarios-gerais-container");
        const comentariosGeraisTextarea = document.getElementById("modal-comentarios-gerais");

        const motivoContainer = document.getElementById("modal-motivo-rejeicao-container");
        const motivoTextarea = document.getElementById("modal-motivo-rejeicao");
        const aprovacaoContainer = document.getElementById("modal-info-aprovacao-container");
        
        // Retorna se os elementos cruciais não estiverem carregados
        if (!motivoContainer || !aprovacaoContainer || !radioSim || !radioNao || !comentariosGeraisContainer) return;

        if (radioNao.checked) {
            // Reprovação: Mostra Motivo (obrigatório) e OCULTA COMENTÁRIOS GERAIS/APROVAÇÃO
            comentariosGeraisContainer.style.display = "none";
            comentariosGeraisTextarea.required = false;

            motivoContainer.style.display = "block";
            motivoTextarea.required = true;
            aprovacaoContainer.style.display = "none";
        } else if (radioSim.checked) {
            // Aprovação: Mostra Comentários Gerais (opcional) e Próximos Passos. Oculta Reprovação
            comentariosGeraisContainer.style.display = "block";
            comentariosGeraisTextarea.required = false; 

            motivoContainer.style.display = "none";
            motivoTextarea.required = false;
            aprovacaoContainer.style.display = "block";
        } else {
            // Nenhum selecionado: Oculta todos os campos de texto detalhados
            comentariosGeraisContainer.style.display = "none";
            comentariosGeraisTextarea.required = false;
            motivoContainer.style.display = "none";
            motivoTextarea.required = false;
            aprovacaoContainer.style.display = "none";
        }
    };
</script>
<script type="module" src="../js/recrutamento.js"></script>